---
# Slackware Linux Benchmark v1.1 - 7.3 Create ftpusers Files
# https://www.debian.org/doc/manuals/securing-debian-manual/ch04s11.en.html#id-1.5.14.12
- name: Update ftpusers
  tags:
    - configuration
    - authorization
    - network
  block:
    - name: getent passwd
      ansible.builtin.getent:
        database: passwd
      tags: check
    - name: Create /etc/ftpusers
      become: true
      ansible.builtin.template:
        src: "{{ playbook_dir }}/templates/ftpusers.j2"
        dest: /etc/ftpusers
        owner: root
        group: root
        mode: '0600'
